{{ define "main" -}}
<div class="side-content">
    {{with .Site.GetPage "me"}}
    <address>
        {{.Content}}
    </address>
    {{end}}

    {{with .Site.GetPage "languages"}}
    <div>
        {{.Content}}
    </div>
    {{end}}

</div>

<main>
    {{ range where (sort .Site.AllPages.ByLinkTitle "File.Path") "File.Dir" "like" "tidbits" -}}
        {{$P:=.Params}}
        <article {{with $P.accent0}} style="--accent0:{{.}}{{with $P.accent1}};--accent1:{{.}}{{end}}"{{end}}>
            <hgroup>
                {{ partial "title-image" .}}
                <h1> {{ .Title }}</h1>
                {{with .Params.subtitle}}
                    <h2>{{.}}</h2>
                {{end}}
            </hgroup>

            {{ .Content }}
        </article>
    {{end }}

    <h1>Projects</h1>
    {{ range where (sort .Site.AllPages "File.Path") "File.Dir" "like" "projects" -}}
        <div class="project card">
            <hgroup>
                {{ partial "title-image" .}}
                <a href={{.Params.p_url}} > <h2>{{.Title}}</h2> </a>
                {{with index ( getJSON .Params.api ) "stargazers_count"}}
                    <div class="stars">{{partial "icon" "star"}}{{.}}</div>
                {{end}}
            </hgroup>
            {{ .Content }}
            {{printf "%s/%s" .Params.api "languages" | getJSON | partial "stacked-bargraph"}}
        </div>
    {{end }}
</main>

{{- end }}
